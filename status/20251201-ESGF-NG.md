# 2025-12-01 ESGF-NG Status

ESGF-NG status as of December, 2025.

ESGF-NG is the next generation of the core architecture for the Earth System Grid Federation. Designed in 2024 and deployed in 2025, it replaces the ESGF-1.0 core architecture. See [ESGF-NG Docs](../docs/README.md) for further information.

**NOTE:** ESGF-NG will be used for CMIP7 and subsequent activities. *None of the below applies to CMIP6 or earlier activities, with the exception of CORDEX CMIP6, which has not yet been published to ESGF.*


## Monthly Highlights

* Load testing completed successfuly. (See Data Challenges and Load Testing below.)
* Given that none of the CMIP7 modeling teams are ready to publish data, we've pushed our production dates out to December 2025 for "friendly projects" and January 2025 for all projects.
* The bulk of our work has shifted from development and testing to integrating with other ESGF teams. Specifically, we're now coordinating with the publisher application, CORDEX, Rapid Evaluation Framework (REF), and several ESGF data access applications to make certain they're able to use the new architecture. (See sections under Current and Recent Work.)
* The STAC extensions for the CMIP7 and CMIP6 projects produced by the ESGVOC and ESGF CV teams are stabilizing. (See Schemas and Controlled Vocabularies (CVs) below.)


## Current and Recent Work

### Data Challenges and Load Testing

* **Completed:** Data Challenge [01](https://github.com/ESGF/esgf-roadmap/blob/main/data-challenges/01-Publication.md). See 11-23-2025 report for more detail.
* **Completed:** Data Challenge [02](https://github.com/ESGF/esgf-roadmap/blob/main/data-challenges/02-Retraction.md) & [03](https://github.com/ESGF/esgf-roadmap/blob/main/data-challenges/03-Update.md). See 11-23-2025 report for more detail.
* **Completed:** *Load Testing* - We ran two large batches of input data (50,000 catalog updates to each of the East and West catalogs). The data included both CMIP6 and obs4MIPS datasets.  Overall, the testing was successful and the system stood up to sustained publishing activity with the resulting catalogs in acceptable states following the test.

Remaining issues are tracked in [this GitHub project epic](https://github.com/ESGF/esgf-roadmap/issues/94)

### Schemas and Controlled Vocabularies (CVs)
The CMIP6 STAC extension generated by ESGVOC, based on JSON schema provided by the ESGF CV team, has steadily improved and is now validating most of our sample CMIP6 datasets. This is enough to allow us to test the STAC validation code with actionable results.

Remaining issues are tracked in [this GitHub project epic](https://github.com/ESGF/esgf-roadmap/issues/96).

We have informed the ESGF WIP and the ESGVOC team that it is essential that each ESGF project supply JSON schema and STAC extensions before the project will be able to publish data using ESGF-NG.

### Publisher Application
We're working with the developers of the [ESGF Publisher](https://github.com/ESGF/esg-publisher) application (an installable command-line interface tool used by modeling centers) to ensure that it works with the ESGF-NG core architecture. The new features include:
1. Authentication with Globus and EGI Check-in.
2. Publishing with the STAC Transaction API.

This work will continue in December. Issues are tracked in [this GitHub project epic](https://github.com/ESGF/esgf-roadmap/issues/95).

### CORDEX CMIP6
We're preparing to work with the CORDEC team to test CORDEX CMIP6 publishing using ESGF-NG. This is a test publication intended to verify that our new architecture can handle data from a new project. (The CORDEX publication will have to be redone when we have a final deployment of ESGF-NG). The key tasks include:
1. CORDEX must work with the ESGF CV and ESGVOC teams to supply a schema and controlled vocabulary for CORDEX CMIP6 data.
2. CORDEX must make some of their CMIP6 data available for our team to copy to our systems for the test.
3. We will configure the ESGF Publisher application to use the CORDEX CMIP6 schema, and perform a publication run using CORDEX's data, and validate the resulting catalogs.

This work will continue in December. Issues are tracked in [this GitHub project epic](https://github.com/ESGF/esgf-roadmap/issues/106).

### Rapid Evaluation Framework (REF) and Persistent IDs (PIDs)
We're coordinating with the ESGF Rapid Evaluation Framework (REF) project and the ESGF Persistent IDs (PIDs) product to ensure that the ESGF-NG Event Stream and STAC Catalogs meet their needs. In November, our load testing activity produced a new event stream and STAC catalogs with obs4MIPS datasets, which are of interest to the REF team. We've onboarded REF and PID team members and are coordinating with them to inspect the event stream and catalogs and report issues.

This work will continue in December. Issues are tracked in [this GitHub project epic](https://github.com/ESGF/esgf-roadmap/issues/97).

### Discovery and Data Access Applications
We continue to coordinate with ESGF data access application teams as they test ESGF-NG STAC catalogs (specifically, the STAC discovery API and ESGF project schemas and CVs) and report issues. In November, we produced medium-sized East & West STAC catalogs with 100,000 items, including CMIP6 and obs4MIPs collections. These are now available for testing by application teams. The West catalog added STAC aggregation features to enable facet counts in search results. We also implemented new caching in the STAC discovery API to improve performance for commonly requested queries, building on lessons learned from the U.S. ESGF-1.5 project. The West catalog is currently working to add free-text field searches, using code developed in the U.K. by CEDA.

This work will continue in December. Issues are tracked in [this GitHub project epic](https://github.com/ESGF/esgf-roadmap/issues/103).

Data access applications include:
* Radiant Earth STAC Browser
* DKRZâ€™s customisation of the STAC Browser. (Includes support for JupyterLite and visualisations)
* Metagrid
* Intake-esgf
* Esg-pull
* Wget-API
* CMCC
* Climate4Impact
* ESMValTool
* ESGF-py-client - we intend to deprecate this application


## Status of ESGF-NG Components

### Architecture and Design
Our current work is still consistent with the [design as written](https://github.com/ESGF/esgf-roadmap/core_architecture/design.md).

One significant addition (that doesn't change any of the written design) is a dependency in the STAC Transaction API on STAC extensions (JSON schemas) generated by the [esg-vocab](https://github.com/ESGF/esgf-vocab) (aka ESGVOC) project based on specifications coordinated in the ESGF CVs team.
* All ESGF STAC extensions are registered with the STAC community's extensions repository.
* **IMPORTANT:** This addition means that before an ESGF project can publish items, the project must register its metadata schema and controlled vocabularies with the ESGF CV team and the ESGVOC project must publish a STAC extension (aka JSON schema) for the project.

### STAC Discovery API
This is the API used by ESGF client applications to discover ESGF datasets. Each of the East and West STAC Catalogs provides a STAC Discovery API. Both East and West use the STAC community's [STAC-FastAPI](https://github.com/stac-utils/stac-fastapi) implementation, but they use different backends. (East uses an [ElasticSearch backend](https://github.com/stac-utils/stac-fastapi-elasticsearch-opensearch), West uses a [Globus Search backend](https://github.com/esgf2-us/west-discovery).)

See "Discovery and Data Access Applications" above for details of our work in November, including a link to issues currently being tracked.

### Event Consumer
[No significant changes since last month.]

The Event Consumer subscribes to the ESGF Event Stream, reads events from the stream, and performs the corresponding changes in a STAC Catalog. These changes may be addition of new items (PUT) or changes to existing items (POST, PATCH). If the Event Consumer detects a consistency error, it publishes an error to the ESGF Event Stream's error topic. The ESGF event consumer supports (via configuration) either an ElasticSearch or Globus Search index as its backend.

NOTE: The error event schema is preliminary and may change to address issues identified during testing or early data publication.

### STAC Transaction API
[No significant changes since last month.]

The Transaction API enables STAC clients to make changes to the catalog. These changes may be addition of new items (POST) or changes to an existing item (PUT, PATCH). ESGF's STAC catalogs will understand DELETE requests but no client will be authorized to perform them. For each request, the STAC Transaction API:
1. confirms the authorization of the request,
2. validates the item metadata, and
3. posts an event on the ESGF Event Stream.

It does not implement the change in the catalog. Instead, it posts an event on the ESGF event stream with the details of the required change. The catalog change itself is performed by the Event Consumers for each ESGF STAC catalog.

Data Challenge 03 tested all of the functionality described above. We believe the validation code (both for new items and for item changes) is complete and have tested it with our own version of the CMIP6 STAC extension. The metadata validation is still causing issues when using the ESGVOC-generate CMIP6 STAC extension because the CMIP6 CV is not yet stable.

### Event Stream
[No significant changes since last month.]

The ESGF event stream service is operated by Globus as part of the ESGF2-US project.  We are currently using [Confluent Data Streaming](https:/www.confluent.io), a managed Apache Kafka deployment hosted in AWS.

The event stream is currently being used for our ESGF-NG data challenges.
* Write access (ability to post events) is restricted to the East and West STAC catalogs.
* Read access (ability to subscribe to topics and read events) is limited to the CEDA and Globus teams who are conducting the data challenges.
* **We also granted Read access to engineers for the ESGF PID team.** They are evaluating the Event Stream for use in a new version of the ESGF PID service. They are using events generated from our data challenges in this evaluation. Their feedback has already led to improvements to ESGVOC's CMIP6 metadata schema.

We expect to onboard engineers for the ESGF Rapid Evaluation Framework (REF) team in August or September to enable them to explore the event stream with events from one or more ESGF-NG data challenges.

Before beginning production operation, we expect we will redeploy the service on a new Kafka cluster within the Confluent service. This should have no effect on clients other than an endpoint address change.

### Authentication and Authorization
[No significant changes since last month.]

The STAC Transaction API (see above) authenticates all client requests and authorizes requests against active project and data node registrations. The system used for authentication and authorization is configurable.
* For the ESGF-West STAC catalog, authentication is performed via Globus, and registration is performed via Globus Group memberships.
* For the ESGF-East STAC catalog, authentication is performed via EGI-Check In and registration is performed via EGI-Check In attributes.

As of September 2, 2025, we've tested all of the above functionality and it is working as expected.

We have one open issue, which is to enable separate authorization policies for replica add and replica remove operations. Separate policies are needed because for these operations, authorization should be based on the data node making the change, rather than the modeling team making the change.

NOTE: The current EGI-Check In implementation uses the OIDC authorization code flow. At some point in the future (as a low-priority development), CEDA plans to change this to the OIDC device flow.

### Catalog Consistency Errors
[No significant changes since last month.]

When catalog changes are requested via the STAC API (new items or updates to existing items), the API is not designed to return an error code to the calling client application if the change cannot be made in the catalog because of a consistency error. (E.g., if a new item is published and it conflicts with an existing item, or if a retraction is requested and the item does not exist.) Instead, the API always returns a code indicating a deferred operation. If the change cannot be made in the STAC catalog, the catalog will generate an error on the ESGF Event Stream's "errors" topic.

We currently do not have a plan for how to respond to errors reported on the Event Stream.

### Production Deployments
[No significant changes since last month.]

* **Both catalogs:**
  * Both East and West have performed multiple deployments of the STAC Transaction API, Event Consumer, and STAC Discovery API for the data challenges. We are preparing documentation and plans for these deployments to be handled by local operations personnel by the time we launch the public ESGF-NG service.
  * East and West are using common STAC Transaction API code (with separate configs for auth, Globus v. EGI Check-In) and common event consumer code (with separate backends: Globus Search and ElasticSearch).
  * The catalogs still use separate STAC Discovery API code. (No plans to change that, presently.)
  * Code to support controlled vocabulary validation is pending a feature release from the ESGVOC project.
* **West catalog:**
  * The West catalog supports Globus authentication and authorization and uses a Globus Search backend.
* **East catalog:**
  * The East catalog supports EGI Check-In authentication and authorization and uses an ElasticSearch backend (hosted on JASMIN).

The CEDA team is looking into moving its STAC API to the production URL.

The Globus team is working with our Operations team and acquisitions at Argonne National Laboratory to deploy production deployments of the ESGF-West core architecture.

### Publisher Registration
[No significant changes since last month.]

Publisher registration for both East and West STAC catalogs is currently a manual process. Catalog operators must manually set up authorization policy.

### ESGF Replicator Application
[No significant changes since last month.]

The ESGF Replicator application is a planned ESGF application to be used by ESGF data node operators. When deployed and configured by an ESGF data node operator, the application will monitor the ESGF event stream for new and updated datasets. When datasets are seen that match a local replication profile, the application will create replicas of those datasets on the data node. If the data node is authorized to do so, the application will also update the datasets' entries in the ESGF STAC catalog to register the new replicas.

There is currently no written technical design for the ESGF Replicator application.  See the [GitHub Repository](https://github.com/ESGF2-us/esgf-replicator) for user stories, requirements, and key design points.


## Timelines

| The Past | Activity |
| --- | --- |
| 2019-11 | ESGF Future Architecture workshop held in UK - [Report](https://doi.org/10.5281/zenodo.3928223) |
| 2024-04 | ESGF-NG proposed at 10th ESGF conference in Bethesda, MD (USA) |
| 2024-11 | ESGF mini-conference in Abingdon (UK); Data challenges proposed and challenges 1-3 designed and scheduled for Jan/Feb 2025 |
| 2024-12-13 | Globus performs Data Challenge 01 round 1. (Includes end-to-end basic CMIP6 dataset publication.)|
| 2025-01-30 | CEDA performs Data Challenge 01 round 1. |
| 2025-03-25 | Data Challenge 01 round 2 completed. (Includes both Globus and EGI-Check In authorization and schema-level validation.) |
| 2025-05-01 | ESGVOC team provided first version of STAC generator capability for ESGF projects |
| 2025-07-01 | STAC Transaction API uses STAC extensions generated by ESGVOC for item validation. Extensions are available for CMIP6, Input4MIPS, and Obs4MIPS. |
| 2025-07-01 | Onboarded engineers from the ESGF PID team to the Event Stream for preliminary evaluation. (See Event Stream below for outcomes.)|
| 2025-08-19 | [Data Challenge 03](https://github.com/lliming/esgf-roadmap/blob/main/data-challenges/03-Update.md) completed. (Includes dataset updates and retractions and catalog consistency errors reported on the event stream.) **East & West catalogs available for client testing. See link above for references.**|
|2025-09-29 | West catalog updated to support additional STAC search filters, paging, and term count aggregations (aka facets). See Data Challenge 03 link above for API endpoint.|
| 2025-11-18 | First load testing run completed. (Includes controlled vocabulary validation, datasets from CMIP6 and Obs4MIPs, minimum of 100,000 events.) **East & West catalogs available for client testing.**|

The following timeline is estimated and subject to change.

| The Future | Activity |
| 2025-12-01 | Target for establishing production ESGF-NG publication capability for "friendly projects" |
| 2026-01-05 | Target for production ESGF-NG publication capability for all ESGF projects |
